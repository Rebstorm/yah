{"hash":"d58cc9dc411032d8017776c0d82178f9bdfa6a64","fesm2020":{"code":"import * as i0 from '@angular/core';\nimport { Injectable, Component, ViewChild, NgModule } from '@angular/core';\nimport * as i4$1 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport { tap, map, filter, switchMap, take, timestamp, delay, repeat, timeout, debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { combineLatest, of, concat, EMPTY, empty } from 'rxjs';\nimport * as i1 from '@angular/common/http';\nimport * as i2 from '@ngx-pwa/local-storage';\nimport * as i3 from '@angular/router';\nimport * as i4 from '@ngneat/hot-toast';\nimport { HotToastModule } from '@ngneat/hot-toast';\nimport * as i2$1 from 'ngx-spinner';\n\nclass LightService {\n    constructor(http, localDb, router, toastMessage) {\n        this.http = http;\n        this.localDb = localDb;\n        this.router = router;\n        this.toastMessage = toastMessage;\n        this.HUE_ISACTIVATED_KEY = 'HUE_ACTIVATED';\n        this.HUE_USERNAME_KEY = 'HUE_USERNAME';\n        this.HUE_URL_KEY = 'HUE_URL';\n        this.isActivated$ = localDb\n            .get(this.HUE_ISACTIVATED_KEY, { type: 'boolean' })\n            .pipe(tap((res) => (this.isActivated = res)));\n        this.hueBridgeIp$ = combineLatest([\n            localDb.watch(this.HUE_URL_KEY, { type: 'string' }),\n            this.isActivated$,\n        ]).pipe(map(([res, isActivated]) => {\n            if (isActivated === undefined) {\n                this.toastMessage.warning('Lass uns uns sachen erstmal einstellen ', {\n                    style: {\n                        background: 'rgba(255, 255, 255, 0.8)',\n                    },\n                    dismissible: true,\n                    ariaLive: 'polite',\n                });\n                this.router.navigate(['setup', { outlets: { options: 'light' } }]).then();\n                return;\n            }\n            return res;\n        }), tap((res) => (this.hueBridgeUrl = res)));\n        this.validHueBridgeIp$ = this.hueBridgeIp$.pipe(map((res) => (res ? true : false)));\n        this.isAuthenticated$ = combineLatest([\n            localDb.get(this.HUE_USERNAME_KEY, { type: 'string' }),\n            this.validHueBridgeIp$,\n            this.isActivated$,\n        ]).pipe(map(([username, validIP, isActivated]) => {\n            if (!isActivated) {\n                return;\n            }\n            if (!validIP) {\n                this.toastMessage.error('Leider fehlt informationen von die Philips Hue.', {\n                    style: {\n                        background: 'rgba(255, 255, 255, 0.8)',\n                    },\n                    dismissible: true,\n                    ariaLive: 'polite',\n                });\n                return;\n            }\n            return username;\n        }), tap((localIndexDb) => {\n            this.username = localIndexDb;\n        }), map((localIndexDb) => {\n            return localIndexDb ? true : false;\n        }));\n        this.turnOffAllLights$ = this.isAuthenticated$.pipe(filter((isAuthenticated) => isAuthenticated === true), switchMap((auth) => this.http.get(`${this.hueBridgeUrl}/${this.username}/lights`)), map((getResult) => {\n            const idList = [];\n            for (const prop in getResult) {\n                if (getResult.hasOwnProperty(prop)) {\n                    idList.push(prop);\n                }\n            }\n            return idList;\n        }), switchMap((lightIdList) => {\n            lightIdList.forEach((light) => this.http\n                .put(`${this.hueBridgeUrl}/${this.username}/lights/${light}/state`, {\n                on: false,\n            })\n                .pipe(take(1))\n                .subscribe());\n            return 'ok';\n        }));\n    }\n    registerAppToBridge() {\n        // TODO: incase of adding another screen, make this more dynamic\n        return this.http\n            .post(this.hueBridgeUrl, { devicetype: 'homescreen#homescreen_1' }, {})\n            .pipe(map((res) => res.pop()), switchMap((res) => {\n            if (res.success?.username) {\n                this.username = res.success.username;\n                this.localDb\n                    .set(this.HUE_USERNAME_KEY, res.success.username, {\n                    type: 'string',\n                })\n                    .pipe(take(1))\n                    .subscribe();\n                return of(true);\n            }\n            else {\n                return of(false);\n            }\n        }), timestamp(), switchMap(({ timestamp: ts, value: value }) => concat(of(value), EMPTY.pipe(delay(5000)))), repeat());\n    }\n    checkHueBridgeIp(ip) {\n        let formattedIp = ip.replace('http://', '');\n        formattedIp = formattedIp.replace('/api', '');\n        formattedIp = formattedIp.replace('/', '');\n        return this.isIp(formattedIp)\n            ? this.http\n                .get(`http://${formattedIp}/api/randomResource`, {\n                observe: 'response',\n            })\n                .pipe(timeout(3000))\n            : empty();\n    }\n    isIp(ipaddress) {\n        if (/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ipaddress)) {\n            return true;\n        }\n        return false;\n    }\n    saveHueBridgeIp(ip) {\n        let formattedIp = ip.replace('http://', '');\n        formattedIp = formattedIp.replace('/api', '');\n        formattedIp = formattedIp.replace('/', '');\n        return this.localDb.set(this.HUE_URL_KEY, `http://${formattedIp}/api`, {\n            type: 'string',\n        });\n    }\n    saveActivated(isActivated) {\n        return this.localDb.set(this.HUE_ISACTIVATED_KEY, isActivated, {\n            type: 'boolean',\n        });\n    }\n}\nLightService.ɵfac = function LightService_Factory(t) { return new (t || LightService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.StorageMap), i0.ɵɵinject(i3.Router), i0.ɵɵinject(i4.HotToastService)); };\nLightService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: LightService, factory: LightService.ɵfac, providedIn: 'root' });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightService, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root',\n            }]\n    }], function () { return [{ type: i1.HttpClient }, { type: i2.StorageMap }, { type: i3.Router }, { type: i4.HotToastService }]; }, null); })();\n\nfunction LightButtonComponent_div_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵelement(1, \"img\", 5);\n    i0.ɵɵtext(2, \" Licht\");\n    i0.ɵɵelementEnd();\n} }\nfunction LightButtonComponent_div_2_Template(rf, ctx) { if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelementStart(1, \"div\", 7);\n    i0.ɵɵlistener(\"click\", function LightButtonComponent_div_2_Template_div_click_1_listener() { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.turnOffAllLights(); });\n    i0.ɵɵtext(2, \" Licht ausmachen \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n} }\nfunction LightButtonComponent_div_3_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelementStart(1, \"ngx-spinner\", 9);\n    i0.ɵɵelementStart(2, \"p\", 10);\n    i0.ɵɵtext(3, \" Bitte die App an der Hue Bridge freigeben \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"fullScreen\", false);\n} }\nclass LightButtonComponent {\n    constructor(lightsService, ngxSpinnerService, hotToast) {\n        this.lightsService = lightsService;\n        this.ngxSpinnerService = ngxSpinnerService;\n        this.hotToast = hotToast;\n        this.clickHueButton = false;\n        this.isAuthenticatedSub = this.lightsService.isAuthenticated$.subscribe((authenticated) => authenticated === false\n            ? this.tellUserToAuthenticate()\n            : this.setupLightConnection());\n    }\n    ngOnDestroy() {\n        if (!this.isAuthenticatedSub.closed) {\n            this.isAuthenticatedSub.unsubscribe();\n        }\n    }\n    ngOnInit() { }\n    tellUserToAuthenticate() {\n        this.registerAuthBridge = this.lightsService\n            .registerAppToBridge()\n            .subscribe((isAuthed) => {\n            if (!isAuthed) {\n                this.hotToast.show('Philips Hue Brauche Ihre Aufmerksamkeit!', {\n                    style: {\n                        background: 'rgba(255, 255, 255, 0.8)',\n                    },\n                    id: 'philips-hue',\n                    ariaLive: 'polite',\n                });\n                this.clickHueButton = true;\n                this.ngxSpinnerService.show('light-auth-spinner');\n            }\n            else {\n                this.setupLightConnection();\n                this.registerAuthBridge.unsubscribe();\n            }\n        });\n    }\n    setupLightConnection() {\n        this.clickHueButton = false;\n        if (this.isAuthenticatedSub && !this.isAuthenticatedSub.closed) {\n            this.isAuthenticatedSub.unsubscribe();\n        }\n    }\n    turnOffAllLights() {\n        this.lightsService.turnOffAllLights$\n            .pipe(take(1))\n            .subscribe((res) => console.log(res));\n    }\n}\nLightButtonComponent.ɵfac = function LightButtonComponent_Factory(t) { return new (t || LightButtonComponent)(i0.ɵɵdirectiveInject(LightService), i0.ɵɵdirectiveInject(i2$1.NgxSpinnerService), i0.ɵɵdirectiveInject(i4.HotToastService)); };\nLightButtonComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: LightButtonComponent, selectors: [[\"yah-light-button\"]], decls: 4, vars: 3, consts: [[1, \"box\"], [\"class\", \"header\", 4, \"ngIf\"], [\"class\", \"content\", 4, \"ngIf\"], [\"class\", \"authenticate-box\", 4, \"ngIf\"], [1, \"header\"], [\"src\", \"./assets/lamp.svg\"], [1, \"content\"], [1, \"glass-button\", 3, \"click\"], [1, \"authenticate-box\"], [\"name\", \"light-auth-spinner\", \"bdColor\", \"rgba(0,0,0,0)\", \"size\", \"medium\", \"color\", \"#fff\", \"type\", \"ball-scale\", 3, \"fullScreen\"], [2, \"color\", \"white\"]], template: function LightButtonComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, LightButtonComponent_div_1_Template, 3, 0, \"div\", 1);\n        i0.ɵɵtemplate(2, LightButtonComponent_div_2_Template, 3, 0, \"div\", 2);\n        i0.ɵɵtemplate(3, LightButtonComponent_div_3_Template, 4, 1, \"div\", 3);\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.clickHueButton);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.clickHueButton);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.clickHueButton);\n    } }, directives: [i4$1.NgIf], styles: [\".box[_ngcontent-%COMP%]{background:rgba(255,255,255,.25);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;min-height:20rem;min-width:20rem;max-width:40rem;transition:all 50ms ease;position:relative}.box[_ngcontent-%COMP%]:active{box-shadow:0 .4rem 2rem #0000005e}.box[_ngcontent-%COMP%]   .authenticate-box[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:.7rem;min-height:inherit;max-width:inherit;background:rgba(255,255,255,.25);backdrop-filter:blur(.7rem);-webkit-backdrop-filter:blur(.7rem)}.box[_ngcontent-%COMP%]   .authenticate-box[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:6rem;height:6rem}.box[_ngcontent-%COMP%]   .authenticate-box[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{width:6rem;height:6rem;word-wrap:break-word;padding:1rem}.box[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-radius:.7rem .7rem 0 0;background:#fff;color:#000;font-size:2rem;display:grid;grid-template-columns:20fr 80fr;padding:.5rem 1rem}.box[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3rem;height:3rem}.content[_ngcontent-%COMP%]{display:flex;justify-content:center}.content[_ngcontent-%COMP%]   .glass-button[_ngcontent-%COMP%]{padding:1.5rem;margin-top:3rem;background:#d91313;border-radius:.7rem;box-shadow:0 .4rem 2rem #1f26875e;transition:all 50ms ease}.content[_ngcontent-%COMP%]   .glass-button[_ngcontent-%COMP%]:active{background:#ea1313}\"] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightButtonComponent, [{\n        type: Component,\n        args: [{ selector: 'yah-light-button', template: \"<div class=\\\"box\\\">\\n  <div *ngIf=\\\"!clickHueButton\\\" class=\\\"header\\\"><img src=\\\"./assets/lamp.svg\\\" /> Licht</div>\\n\\n  <div *ngIf=\\\"!clickHueButton\\\" class=\\\"content\\\">\\n    <div class=\\\"glass-button\\\" (click)=\\\"turnOffAllLights()\\\"> Licht ausmachen </div>\\n  </div>\\n\\n  <div class=\\\"authenticate-box\\\" *ngIf=\\\"clickHueButton\\\">\\n    <ngx-spinner\\n      name=\\\"light-auth-spinner\\\"\\n      bdColor=\\\"rgba(0,0,0,0)\\\"\\n      size=\\\"medium\\\"\\n      color=\\\"#fff\\\"\\n      type=\\\"ball-scale\\\"\\n      [fullScreen]=\\\"false\\\"\\n      ><p style=\\\"color: white\\\">\\n        Bitte die App an der Hue Bridge freigeben\\n      </p></ngx-spinner\\n    >\\n  </div>\\n</div>\\n\\n<!-- <div>Icons made by <a href=\\\"https://www.flaticon.com/authors/pixel-perfect\\\" title=\\\"Pixel perfect\\\">Pixel perfect</a> from <a href=\\\"https://www.flaticon.com/\\\" title=\\\"Flaticon\\\">www.flaticon.com</a></div>\\n-->\\n\", styles: [\".box{background:rgba(255,255,255,.25);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;min-height:20rem;min-width:20rem;max-width:40rem;transition:all 50ms ease;position:relative}.box:active{box-shadow:0 .4rem 2rem #0000005e}.box .authenticate-box{display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:.7rem;min-height:inherit;max-width:inherit;background:rgba(255,255,255,.25);backdrop-filter:blur(.7rem);-webkit-backdrop-filter:blur(.7rem)}.box .authenticate-box>img{width:6rem;height:6rem}.box .authenticate-box .text{width:6rem;height:6rem;word-wrap:break-word;padding:1rem}.box .header{border-radius:.7rem .7rem 0 0;background:#fff;color:#000;font-size:2rem;display:grid;grid-template-columns:20fr 80fr;padding:.5rem 1rem}.box .header img{width:3rem;height:3rem}.content{display:flex;justify-content:center}.content .glass-button{padding:1.5rem;margin-top:3rem;background:#d91313;border-radius:.7rem;box-shadow:0 .4rem 2rem #1f26875e;transition:all 50ms ease}.content .glass-button:active{background:#ea1313}\\n\"] }]\n    }], function () { return [{ type: LightService }, { type: i2$1.NgxSpinnerService }, { type: i4.HotToastService }]; }, null); })();\n\nconst _c0 = [\"ipInput\"];\nclass LightSetupComponent {\n    constructor(lightService, toastMessage) {\n        this.lightService = lightService;\n        this.toastMessage = toastMessage;\n        this.validIp = 'disconnected';\n        this.isActivated = false;\n        this.lightService.hueBridgeIp$.subscribe((res) => {\n            if (res) {\n                this.ipInput.nativeElement.value = res;\n                this.validIp = 'connected';\n            }\n        });\n        this.lightService.isActivated$.subscribe((res) => {\n            this.isActivated = res;\n        });\n    }\n    ngOnInit() { }\n    checkIP() {\n        const input = this.ipInput.nativeElement.value;\n        if (input.length > 1) {\n            this.validIp = 'loading';\n            // Have we already fired it? Then let it run out..\n            if (this.checkingSubscription) {\n                this.checkingSubscription.unsubscribe();\n            }\n            this.checkingSubscription = this.lightService\n                .checkHueBridgeIp(input)\n                .pipe(debounceTime(750), distinctUntilChanged(), take(1))\n                .subscribe((res) => {\n                res.status === 200\n                    ? this.setNewHueValidIp(input)\n                    : this.showErrorMessage();\n            }, (err) => this.showErrorMessage());\n        }\n    }\n    showErrorMessage() {\n        this.validIp = 'disconnected';\n    }\n    setNewHueValidIp(input) {\n        this.checkingSubscription.unsubscribe();\n        this.validIp = 'connected';\n        this.lightService.saveHueBridgeIp(input).subscribe(() => {\n            this.toastMessage.success('Philips Hue server Einstellungen sind gespeichert', {\n                style: {\n                    background: 'rgba(255, 255, 255, 0.8)',\n                },\n                dismissible: true,\n                ariaLive: 'polite',\n                id: 'hue-saved',\n            });\n        });\n    }\n    setChecked($event) {\n        const input = $event.target;\n        this.lightService.saveActivated(input.checked).subscribe(() => {\n            this.toastMessage.success('Philips Hue server Einstellungen sind gespeichert', {\n                style: {\n                    background: 'rgba(255, 255, 255, 0.8)',\n                },\n                dismissible: true,\n                ariaLive: 'polite',\n                id: 'hue-saved',\n            });\n        });\n    }\n}\nLightSetupComponent.ɵfac = function LightSetupComponent_Factory(t) { return new (t || LightSetupComponent)(i0.ɵɵdirectiveInject(LightService), i0.ɵɵdirectiveInject(i4.HotToastService)); };\nLightSetupComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: LightSetupComponent, selectors: [[\"yah-light-setup\"]], viewQuery: function LightSetupComponent_Query(rf, ctx) { if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n    } if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.ipInput = _t.first);\n    } }, decls: 16, vars: 4, consts: [[\"src\", \"assets/lamp.svg\", \"width\", \"32\"], [1, \"no-margin\"], [1, \"switch\"], [\"type\", \"checkbox\", 3, \"checked\", \"change\"], [1, \"slider\"], [1, \"input-row\"], [\"type\", \"text\", 1, \"input-frosted\", 3, \"input\"], [\"ipInput\", \"\"]], template: function LightSetupComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\");\n        i0.ɵɵelementStart(1, \"h2\");\n        i0.ɵɵelement(2, \"img\", 0);\n        i0.ɵɵtext(3, \" Philips Hue Server Einstellungen \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"p\", 1);\n        i0.ɵɵtext(5, \" Aktiviert \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"label\", 2);\n        i0.ɵɵelementStart(7, \"input\", 3);\n        i0.ɵɵlistener(\"change\", function LightSetupComponent_Template_input_change_7_listener($event) { return ctx.setChecked($event); });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(8, \"span\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"p\");\n        i0.ɵɵelementStart(10, \"p\", 1);\n        i0.ɵɵtext(11, \" IP \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 5);\n        i0.ɵɵelementStart(13, \"input\", 6, 7);\n        i0.ɵɵlistener(\"input\", function LightSetupComponent_Template_input_input_13_listener() { return ctx.checkIP(); });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"i\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"checked\", ctx.isActivated);\n        i0.ɵɵadvance(8);\n        i0.ɵɵclassMapInterpolate1(\"symbol \", ctx.validIp, \"\");\n    } }, styles: [\"form[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column}form[_ngcontent-%COMP%]   .no-margin[_ngcontent-%COMP%]{margin:0}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]{display:flex;align-items:center}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .input-frosted[_ngcontent-%COMP%]{color:#fff;font-size:1.4rem;font-weight:800;padding:1rem;border:none;background:rgba(255,255,255,.4);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;max-width:90%}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol[_ngcontent-%COMP%]{width:2rem;height:2rem;margin-left:.5rem}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol.connected[_ngcontent-%COMP%]{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22iso-8859-1%22%3F%3E%0D%3C!-- Generator%3A Adobe Illustrator 19.0.0%2C SVG Export Plug-In . SVG Version%3A 6.00 Build 0)  --%3E%0D%3Csvg version%3D%221.1%22 id%3D%22Layer_1%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 x%3D%220px%22 y%3D%220px%22%0D%09 viewBox%3D%220 0 511.999 511.999%22 style%3D%22enable-background%3Anew 0 0 511.999 511.999%3B%22 xml%3Aspace%3D%22preserve%22%3E%0D%3Cpath style%3D%22fill%3A%23B7E183%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L163.89%2C370.299L53.284%2C259.693%0D%09c-12.201-12.204-31.952-12.205-44.154-0.001c-12.173%2C12.174-12.173%2C31.981%2C0%2C44.153L141.814%2C436.53%0D%09c12.199%2C12.198%2C31.953%2C12.2%2C44.153%2C0L502.87%2C119.626C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cpath style%3D%22fill%3A%2371DE56%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L243.511%2C290.678v88.306L502.87%2C119.626%0D%09C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3C%2Fsvg%3E%0D\\\") no-repeat}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol.disconnected[_ngcontent-%COMP%]{background:url(\\\"data:image/svg+xml,%3Csvg height%3D%22100%25%22 viewBox%3D%220 0 329.26933 329%22 width%3D%2220%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg fill%3D%22%23f44336%22%3E%3Cpath d%3D%22m21.339844 329.398438c-5.460938 0-10.925782-2.089844-15.082032-6.25-8.34375-8.339844-8.34375-21.824219 0-30.164063l286.589844-286.59375c8.339844-8.339844 21.824219-8.339844 30.164063 0 8.34375 8.339844 8.34375 21.824219 0 30.164063l-286.589844 286.59375c-4.183594 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3Cpath d%3D%22m307.929688 329.398438c-5.460938 0-10.921876-2.089844-15.082032-6.25l-286.589844-286.59375c-8.34375-8.339844-8.34375-21.824219 0-30.164063 8.339844-8.339844 21.820313-8.339844 30.164063 0l286.589844 286.59375c8.34375 8.339844 8.34375 21.824219 0 30.164063-4.160157 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\") center no-repeat}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol.loading[_ngcontent-%COMP%]{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22UTF-8%22 standalone%3D%22no%22%3F%3E%3Csvg xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 version%3D%221.0%22 width%3D%22100pt%22 height%3D%22100pt%22 viewBox%3D%220 0 128 128%22 xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23000%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23f8f8f8%22 transform%3D%22rotate(30 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23e8e8e8%22 transform%3D%22rotate(60 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23d4d4d4%22 transform%3D%22rotate(90 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23bebebe%22 transform%3D%22rotate(120 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23a6a6a6%22 transform%3D%22rotate(150 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%238e8e8e%22 transform%3D%22rotate(180 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23737373%22 transform%3D%22rotate(210 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%235a5a5a%22 transform%3D%22rotate(240 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23414141%22 transform%3D%22rotate(270 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%232a2a2a%22 transform%3D%22rotate(300 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23151515%22 transform%3D%22rotate(330 64 64)%22%2F%3E%3CanimateTransform attributeName%3D%22transform%22 type%3D%22rotate%22 values%3D%220 64 64%3B30 64 64%3B60 64 64%3B90 64 64%3B120 64 64%3B150 64 64%3B180 64 64%3B210 64 64%3B240 64 64%3B270 64 64%3B300 64 64%3B330 64 64%22 calcMode%3D%22discrete%22 dur%3D%22240ms%22 repeatCount%3D%22indefinite%22%3E%3C%2FanimateTransform%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\");background-size:contain}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:60px;height:34px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:\\\"\\\";height:26px;width:26px;left:4px;bottom:4px;background-color:#fff;transition:.4s}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2196f3}input[_ngcontent-%COMP%]:focus + .slider[_ngcontent-%COMP%]{box-shadow:0 0 1px #2196f3}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}\"] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightSetupComponent, [{\n        type: Component,\n        args: [{ selector: 'yah-light-setup', template: \"<form>\\n\\n  <h2> <img src=\\\"assets/lamp.svg\\\" width=\\\"32\\\">  Philips Hue Server Einstellungen </h2>\\n  <p class=\\\"no-margin\\\"> Aktiviert </p>\\n  <label class=\\\"switch\\\">\\n    <input type=\\\"checkbox\\\" (change)=\\\"setChecked($event)\\\" [checked]=\\\"isActivated\\\">\\n    <span class=\\\"slider\\\"></span>\\n  </label>\\n\\n\\n  <p></p>\\n\\n  <p class=\\\"no-margin\\\"> IP </p>\\n  <div class=\\\"input-row\\\">\\n    <input #ipInput (input)='checkIP()' type=\\\"text\\\" class=\\\"input-frosted\\\">\\n    <i class=\\\"symbol {{validIp}}\\\" ></i>\\n  </div>\\n</form>\\n\\n\\n<!-- <div>Icons made by <a href=\\\"https://www.flaticon.com/authors/pixel-perfect\\\" title=\\\"Pixel perfect\\\">Pixel perfect</a> from <a href=\\\"https://www.flaticon.com/\\\" title=\\\"Flaticon\\\">www.flaticon.com</a></div> -->\\n\", styles: [\"form{display:flex;justify-content:center;flex-direction:column}form .no-margin{margin:0}form .input-row{display:flex;align-items:center}form .input-row .input-frosted{color:#fff;font-size:1.4rem;font-weight:800;padding:1rem;border:none;background:rgba(255,255,255,.4);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;max-width:90%}form .input-row .symbol{width:2rem;height:2rem;margin-left:.5rem}form .input-row .symbol.connected{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22iso-8859-1%22%3F%3E%0D%3C!-- Generator%3A Adobe Illustrator 19.0.0%2C SVG Export Plug-In . SVG Version%3A 6.00 Build 0)  --%3E%0D%3Csvg version%3D%221.1%22 id%3D%22Layer_1%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 x%3D%220px%22 y%3D%220px%22%0D%09 viewBox%3D%220 0 511.999 511.999%22 style%3D%22enable-background%3Anew 0 0 511.999 511.999%3B%22 xml%3Aspace%3D%22preserve%22%3E%0D%3Cpath style%3D%22fill%3A%23B7E183%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L163.89%2C370.299L53.284%2C259.693%0D%09c-12.201-12.204-31.952-12.205-44.154-0.001c-12.173%2C12.174-12.173%2C31.981%2C0%2C44.153L141.814%2C436.53%0D%09c12.199%2C12.198%2C31.953%2C12.2%2C44.153%2C0L502.87%2C119.626C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cpath style%3D%22fill%3A%2371DE56%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L243.511%2C290.678v88.306L502.87%2C119.626%0D%09C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3C%2Fsvg%3E%0D\\\") no-repeat}form .input-row .symbol.disconnected{background:url(\\\"data:image/svg+xml,%3Csvg height%3D%22100%25%22 viewBox%3D%220 0 329.26933 329%22 width%3D%2220%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg fill%3D%22%23f44336%22%3E%3Cpath d%3D%22m21.339844 329.398438c-5.460938 0-10.925782-2.089844-15.082032-6.25-8.34375-8.339844-8.34375-21.824219 0-30.164063l286.589844-286.59375c8.339844-8.339844 21.824219-8.339844 30.164063 0 8.34375 8.339844 8.34375 21.824219 0 30.164063l-286.589844 286.59375c-4.183594 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3Cpath d%3D%22m307.929688 329.398438c-5.460938 0-10.921876-2.089844-15.082032-6.25l-286.589844-286.59375c-8.34375-8.339844-8.34375-21.824219 0-30.164063 8.339844-8.339844 21.820313-8.339844 30.164063 0l286.589844 286.59375c8.34375 8.339844 8.34375 21.824219 0 30.164063-4.160157 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\") center no-repeat}form .input-row .symbol.loading{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22UTF-8%22 standalone%3D%22no%22%3F%3E%3Csvg xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 version%3D%221.0%22 width%3D%22100pt%22 height%3D%22100pt%22 viewBox%3D%220 0 128 128%22 xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23000%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23f8f8f8%22 transform%3D%22rotate(30 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23e8e8e8%22 transform%3D%22rotate(60 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23d4d4d4%22 transform%3D%22rotate(90 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23bebebe%22 transform%3D%22rotate(120 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23a6a6a6%22 transform%3D%22rotate(150 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%238e8e8e%22 transform%3D%22rotate(180 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23737373%22 transform%3D%22rotate(210 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%235a5a5a%22 transform%3D%22rotate(240 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23414141%22 transform%3D%22rotate(270 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%232a2a2a%22 transform%3D%22rotate(300 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23151515%22 transform%3D%22rotate(330 64 64)%22%2F%3E%3CanimateTransform attributeName%3D%22transform%22 type%3D%22rotate%22 values%3D%220 64 64%3B30 64 64%3B60 64 64%3B90 64 64%3B120 64 64%3B150 64 64%3B180 64 64%3B210 64 64%3B240 64 64%3B270 64 64%3B300 64 64%3B330 64 64%22 calcMode%3D%22discrete%22 dur%3D%22240ms%22 repeatCount%3D%22indefinite%22%3E%3C%2FanimateTransform%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\");background-size:contain}.switch{position:relative;display:inline-block;width:60px;height:34px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider:before{position:absolute;content:\\\"\\\";height:26px;width:26px;left:4px;bottom:4px;background-color:#fff;transition:.4s}input:checked+.slider{background-color:#2196f3}input:focus+.slider{box-shadow:0 0 1px #2196f3}input:checked+.slider:before{transform:translate(26px)}\\n\"] }]\n    }], function () { return [{ type: LightService }, { type: i4.HotToastService }]; }, { ipInput: [{\n            type: ViewChild,\n            args: ['ipInput', { static: true }]\n        }] }); })();\n\nclass LightModule {\n}\nLightModule.ɵfac = function LightModule_Factory(t) { return new (t || LightModule)(); };\nLightModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: LightModule });\nLightModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[CommonModule, HotToastModule]] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightModule, [{\n        type: NgModule,\n        args: [{\n                declarations: [LightButtonComponent, LightSetupComponent],\n                imports: [CommonModule, HotToastModule],\n                exports: [LightButtonComponent, LightSetupComponent],\n            }]\n    }], null, null); })();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(LightModule, { declarations: [LightButtonComponent, LightSetupComponent], imports: [CommonModule, HotToastModule], exports: [LightButtonComponent, LightSetupComponent] }); })();\n\n/*\n * Public API Surface of yah-light\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { LightButtonComponent, LightModule, LightService, LightSetupComponent };\n","map":{"version":3,"file":"yah-light.mjs","sources":["../../../projects/yah-light/src/lib/services/light.service.ts","../../../projects/yah-light/src/lib/components/light-button/light-button.component.html","../../../projects/yah-light/src/lib/components/light-button/light-button.component.ts","../../../projects/yah-light/src/lib/components/light-setup/light-setup.component.ts","../../../projects/yah-light/src/lib/components/light-setup/light-setup.component.html","../../../projects/yah-light/src/lib/light.module.ts","../../../projects/yah-light/src/public-api.ts","../../../projects/yah-light/src/yah-light.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\nimport {combineLatest, concat, empty, EMPTY, Observable, of,} from 'rxjs';\nimport {HttpClient, HttpResponse,} from '@angular/common/http';\nimport {delay, filter, map, repeat, switchMap, take, tap, timeout, timestamp,} from 'rxjs/operators';\nimport {StorageMap} from '@ngx-pwa/local-storage';\nimport {Router} from '@angular/router';\nimport {HotToastService} from '@ngneat/hot-toast';\n\nexport interface HueInternalModel {\n  error?: {\n    type: number;\n    address: string;\n    description: string;\n  };\n  success?: {\n    username: string;\n  };\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LightService {\n  public isActivated$: Observable<boolean>;\n\n  public hueBridgeIp$: Observable<string>;\n  public validHueBridgeIp$: Observable<boolean>;\n\n  public isAuthenticated$: Observable<boolean>;\n\n  public turnOffAllLights$: Observable<string>;\n\n  private isActivated: boolean | undefined;\n  private username: string;\n  private hueBridgeUrl: string;\n\n  private readonly HUE_ISACTIVATED_KEY = 'HUE_ACTIVATED';\n  private readonly HUE_USERNAME_KEY = 'HUE_USERNAME';\n  private readonly HUE_URL_KEY = 'HUE_URL';\n\n  constructor(\n    private http: HttpClient,\n    private localDb: StorageMap,\n    private router: Router,\n    private toastMessage: HotToastService\n  ) {\n    this.isActivated$ = localDb\n      .get(this.HUE_ISACTIVATED_KEY, { type: 'boolean' })\n      .pipe(tap((res) => (this.isActivated = res)));\n\n    this.hueBridgeIp$ = combineLatest([\n      localDb.watch(this.HUE_URL_KEY, { type: 'string' }),\n      this.isActivated$,\n    ]).pipe(\n      map(([res, isActivated]) => {\n        if (isActivated === undefined) {\n          this.toastMessage.warning('Lass uns uns sachen erstmal einstellen ', {\n            style: {\n              background: 'rgba(255, 255, 255, 0.8)',\n            },\n            dismissible: true,\n            ariaLive: 'polite',\n          });\n          this.router.navigate(['setup', { outlets: { options: 'light' } }], ).then();\n          return;\n        }\n        return res;\n      }),\n      tap((res) => (this.hueBridgeUrl = res))\n    );\n\n    this.validHueBridgeIp$ = this.hueBridgeIp$.pipe(\n      map((res) => (res ? true : false))\n    );\n\n    this.isAuthenticated$ = combineLatest([\n      localDb.get<boolean>(this.HUE_USERNAME_KEY, { type: 'string' }),\n      this.validHueBridgeIp$,\n      this.isActivated$,\n    ]).pipe(\n      map(([username, validIP, isActivated]) => {\n        if (!isActivated) {\n          return;\n        }\n\n        if (!validIP) {\n          this.toastMessage.error(\n            'Leider fehlt informationen von die Philips Hue.',\n            {\n              style: {\n                background: 'rgba(255, 255, 255, 0.8)',\n              },\n              dismissible: true,\n              ariaLive: 'polite',\n            }\n          );\n          return;\n        }\n        return username;\n      }),\n      tap((localIndexDb) => {\n        this.username = localIndexDb;\n      }),\n      map((localIndexDb) => {\n        return localIndexDb ? true : false;\n      })\n    );\n\n    this.turnOffAllLights$ = this.isAuthenticated$.pipe(\n      filter((isAuthenticated) => isAuthenticated === true),\n      switchMap((auth) =>\n        this.http.get<JSON>(`${this.hueBridgeUrl}/${this.username}/lights`)\n      ),\n      map((getResult) => {\n        const idList: string[] = [];\n        for (const prop in getResult) {\n          if (getResult.hasOwnProperty(prop)) {\n            idList.push(prop);\n          }\n        }\n        return idList;\n      }),\n      switchMap((lightIdList) => {\n        lightIdList.forEach((light) =>\n          this.http\n            .put(\n              `${this.hueBridgeUrl}/${this.username}/lights/${light}/state`,\n              {\n                on: false,\n              }\n            )\n            .pipe(take(1))\n            .subscribe()\n        );\n\n        return 'ok';\n      })\n    );\n  }\n\n  public registerAppToBridge(): Observable<boolean> {\n    // TODO: incase of adding another screen, make this more dynamic\n    return this.http\n      .post<HueInternalModel[]>(\n        this.hueBridgeUrl,\n        { devicetype: 'homescreen#homescreen_1' },\n        {}\n      )\n      .pipe(\n        map((res) => res.pop()),\n        switchMap((res) => {\n          if (res.success?.username) {\n            this.username = res.success.username;\n            this.localDb\n              .set(this.HUE_USERNAME_KEY, res.success.username, {\n                type: 'string',\n              })\n              .pipe(take(1))\n              .subscribe();\n            return of(true);\n          } else {\n            return of(false);\n          }\n        }),\n        timestamp(),\n        switchMap(({ timestamp: ts, value: value }) =>\n          concat(of(value), EMPTY.pipe(delay(5000)))\n        ),\n        repeat()\n      );\n  }\n\n  public checkHueBridgeIp(ip: string): Observable<HttpResponse<any>> {\n    let formattedIp = ip.replace('http://', '');\n    formattedIp = formattedIp.replace('/api', '');\n    formattedIp = formattedIp.replace('/', '');\n    return this.isIp(formattedIp)\n      ? this.http\n          .get<HttpResponse<any>>(`http://${formattedIp}/api/randomResource`, {\n            observe: 'response',\n          })\n          .pipe(timeout(3000))\n      : empty();\n  }\n\n  private isIp(ipaddress: string): boolean {\n    if (\n      /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(\n        ipaddress\n      )\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  public saveHueBridgeIp(ip: string): Observable<null> {\n    let formattedIp = ip.replace('http://', '');\n    formattedIp = formattedIp.replace('/api', '');\n    formattedIp = formattedIp.replace('/', '');\n\n    return this.localDb.set(this.HUE_URL_KEY, `http://${formattedIp}/api`, {\n      type: 'string',\n    });\n  }\n\n  saveActivated(isActivated: boolean): Observable<null> {\n    return this.localDb.set(this.HUE_ISACTIVATED_KEY, isActivated, {\n      type: 'boolean',\n    });\n  }\n}\n","<div class=\"box\">\n  <div *ngIf=\"!clickHueButton\" class=\"header\"><img src=\"./assets/lamp.svg\" /> Licht</div>\n\n  <div *ngIf=\"!clickHueButton\" class=\"content\">\n    <div class=\"glass-button\" (click)=\"turnOffAllLights()\"> Licht ausmachen </div>\n  </div>\n\n  <div class=\"authenticate-box\" *ngIf=\"clickHueButton\">\n    <ngx-spinner\n      name=\"light-auth-spinner\"\n      bdColor=\"rgba(0,0,0,0)\"\n      size=\"medium\"\n      color=\"#fff\"\n      type=\"ball-scale\"\n      [fullScreen]=\"false\"\n      ><p style=\"color: white\">\n        Bitte die App an der Hue Bridge freigeben\n      </p></ngx-spinner\n    >\n  </div>\n</div>\n\n<!-- <div>Icons made by <a href=\"https://www.flaticon.com/authors/pixel-perfect\" title=\"Pixel perfect\">Pixel perfect</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div>\n-->\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { LightService } from '../../services/light.service';\nimport { NgxSpinnerService } from 'ngx-spinner';\nimport { Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { HotToastService } from '@ngneat/hot-toast';\n\n@Component({\n  selector: 'yah-light-button',\n  templateUrl: './light-button.component.html',\n  styleUrls: ['./light-button.component.scss'],\n})\nexport class LightButtonComponent implements OnInit, OnDestroy {\n  clickHueButton = false;\n\n  isAuthenticatedSub: Subscription;\n  registerAuthBridge: Subscription;\n\n  constructor(\n    private lightsService: LightService,\n    private ngxSpinnerService: NgxSpinnerService,\n    private hotToast: HotToastService\n  ) {\n    this.isAuthenticatedSub = this.lightsService.isAuthenticated$.subscribe(\n      (authenticated) =>\n        authenticated === false\n          ? this.tellUserToAuthenticate()\n          : this.setupLightConnection()\n    );\n  }\n\n  ngOnDestroy(): void {\n    if (!this.isAuthenticatedSub.closed){\n      this.isAuthenticatedSub.unsubscribe();\n    }\n  }\n\n  ngOnInit(): void {}\n\n  private tellUserToAuthenticate(): void {\n    this.registerAuthBridge = this.lightsService\n      .registerAppToBridge()\n      .subscribe((isAuthed) => {\n        if (!isAuthed) {\n          this.hotToast.show('Philips Hue Brauche Ihre Aufmerksamkeit!', {\n            style: {\n              background: 'rgba(255, 255, 255, 0.8)',\n            },\n            id: 'philips-hue',\n            ariaLive: 'polite',\n          });\n          this.clickHueButton = true;\n          this.ngxSpinnerService.show('light-auth-spinner');\n        } else {\n          this.setupLightConnection();\n          this.registerAuthBridge.unsubscribe();\n        }\n      });\n  }\n\n  private setupLightConnection(): void {\n    this.clickHueButton = false;\n\n    if (this.isAuthenticatedSub && !this.isAuthenticatedSub.closed) {\n      this.isAuthenticatedSub.unsubscribe();\n    }\n  }\n\n  public turnOffAllLights(): void {\n    this.lightsService.turnOffAllLights$\n      .pipe(take(1))\n      .subscribe((res) => console.log(res));\n  }\n}\n","import { debounceTime, distinctUntilChanged, take } from 'rxjs/operators';\nimport { LightService } from './../../services/light.service';\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { HotToastService } from '@ngneat/hot-toast';\n\n@Component({\n  selector: 'yah-light-setup',\n  templateUrl: './light-setup.component.html',\n  styleUrls: ['./light-setup.component.scss'],\n})\nexport class LightSetupComponent implements OnInit {\n  @ViewChild('ipInput', { static: true }) ipInput: ElementRef<HTMLInputElement>;\n\n  checkingSubscription: Subscription;\n\n  validIp = 'disconnected';\n  isActivated = false;\n\n  constructor(\n    private lightService: LightService,\n    private toastMessage: HotToastService\n  ) {\n    this.lightService.hueBridgeIp$.subscribe((res) => {\n      if (res) {\n        this.ipInput.nativeElement.value = res;\n        this.validIp = 'connected';\n      }\n    });\n\n    this.lightService.isActivated$.subscribe((res) => {\n      this.isActivated = res;\n    });\n  }\n\n  ngOnInit(): void {}\n\n  public checkIP(): void {\n    const input = this.ipInput.nativeElement.value;\n\n    if (input.length > 1) {\n      this.validIp = 'loading';\n\n      // Have we already fired it? Then let it run out..\n      if (this.checkingSubscription) {\n        this.checkingSubscription.unsubscribe();\n      }\n\n      this.checkingSubscription = this.lightService\n        .checkHueBridgeIp(input)\n        .pipe(debounceTime(750), distinctUntilChanged(), take(1))\n        .subscribe(\n          (res) => {\n            res.status === 200\n              ? this.setNewHueValidIp(input)\n              : this.showErrorMessage();\n          },\n          (err) => this.showErrorMessage()\n        );\n    }\n  }\n  public showErrorMessage(): void {\n    this.validIp = 'disconnected';\n  }\n  public setNewHueValidIp(input: string): void {\n    this.checkingSubscription.unsubscribe();\n    this.validIp = 'connected';\n    this.lightService.saveHueBridgeIp(input).subscribe(() => {\n      this.toastMessage.success(\n        'Philips Hue server Einstellungen sind gespeichert',\n        {\n          style: {\n            background: 'rgba(255, 255, 255, 0.8)',\n          },\n          dismissible: true,\n          ariaLive: 'polite',\n          id: 'hue-saved',\n        }\n      );\n    });\n  }\n\n  public setChecked($event: Event): void {\n    const input = $event.target as HTMLInputElement;\n    this.lightService.saveActivated(input.checked).subscribe(() => {\n      this.toastMessage.success(\n        'Philips Hue server Einstellungen sind gespeichert',\n        {\n          style: {\n            background: 'rgba(255, 255, 255, 0.8)',\n          },\n          dismissible: true,\n          ariaLive: 'polite',\n          id: 'hue-saved',\n        }\n      );\n    });\n  }\n}\n","<form>\n\n  <h2> <img src=\"assets/lamp.svg\" width=\"32\">  Philips Hue Server Einstellungen </h2>\n  <p class=\"no-margin\"> Aktiviert </p>\n  <label class=\"switch\">\n    <input type=\"checkbox\" (change)=\"setChecked($event)\" [checked]=\"isActivated\">\n    <span class=\"slider\"></span>\n  </label>\n\n\n  <p></p>\n\n  <p class=\"no-margin\"> IP </p>\n  <div class=\"input-row\">\n    <input #ipInput (input)='checkIP()' type=\"text\" class=\"input-frosted\">\n    <i class=\"symbol {{validIp}}\" ></i>\n  </div>\n</form>\n\n\n<!-- <div>Icons made by <a href=\"https://www.flaticon.com/authors/pixel-perfect\" title=\"Pixel perfect\">Pixel perfect</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div> -->\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {LightButtonComponent} from './components/light-button/light-button.component';\nimport {LightSetupComponent} from './components/light-setup/light-setup.component';\nimport {HotToastModule} from '@ngneat/hot-toast';\n\n@NgModule({\n  declarations: [LightButtonComponent, LightSetupComponent],\n  imports: [CommonModule, HotToastModule],\n  exports: [LightButtonComponent, LightSetupComponent],\n})\nexport class LightModule {}\n","/*\n * Public API Surface of yah-light\n */\n\nexport * from './lib/light.module';\nexport * from './lib/components/light-button/light-button.component';\nexport * from './lib/components/light-setup/light-setup.component';\n\nexport * from './lib/services/light.service';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}},"fesm2015":{"code":"import * as i0 from '@angular/core';\nimport { Injectable, Component, ViewChild, NgModule } from '@angular/core';\nimport * as i4$1 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport { tap, map, filter, switchMap, take, timestamp, delay, repeat, timeout, debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { combineLatest, of, concat, EMPTY, empty } from 'rxjs';\nimport * as i1 from '@angular/common/http';\nimport * as i2 from '@ngx-pwa/local-storage';\nimport * as i3 from '@angular/router';\nimport * as i4 from '@ngneat/hot-toast';\nimport { HotToastModule } from '@ngneat/hot-toast';\nimport * as i2$1 from 'ngx-spinner';\n\nclass LightService {\n    constructor(http, localDb, router, toastMessage) {\n        this.http = http;\n        this.localDb = localDb;\n        this.router = router;\n        this.toastMessage = toastMessage;\n        this.HUE_ISACTIVATED_KEY = 'HUE_ACTIVATED';\n        this.HUE_USERNAME_KEY = 'HUE_USERNAME';\n        this.HUE_URL_KEY = 'HUE_URL';\n        this.isActivated$ = localDb\n            .get(this.HUE_ISACTIVATED_KEY, { type: 'boolean' })\n            .pipe(tap((res) => (this.isActivated = res)));\n        this.hueBridgeIp$ = combineLatest([\n            localDb.watch(this.HUE_URL_KEY, { type: 'string' }),\n            this.isActivated$,\n        ]).pipe(map(([res, isActivated]) => {\n            if (isActivated === undefined) {\n                this.toastMessage.warning('Lass uns uns sachen erstmal einstellen ', {\n                    style: {\n                        background: 'rgba(255, 255, 255, 0.8)',\n                    },\n                    dismissible: true,\n                    ariaLive: 'polite',\n                });\n                this.router.navigate(['setup', { outlets: { options: 'light' } }]).then();\n                return;\n            }\n            return res;\n        }), tap((res) => (this.hueBridgeUrl = res)));\n        this.validHueBridgeIp$ = this.hueBridgeIp$.pipe(map((res) => (res ? true : false)));\n        this.isAuthenticated$ = combineLatest([\n            localDb.get(this.HUE_USERNAME_KEY, { type: 'string' }),\n            this.validHueBridgeIp$,\n            this.isActivated$,\n        ]).pipe(map(([username, validIP, isActivated]) => {\n            if (!isActivated) {\n                return;\n            }\n            if (!validIP) {\n                this.toastMessage.error('Leider fehlt informationen von die Philips Hue.', {\n                    style: {\n                        background: 'rgba(255, 255, 255, 0.8)',\n                    },\n                    dismissible: true,\n                    ariaLive: 'polite',\n                });\n                return;\n            }\n            return username;\n        }), tap((localIndexDb) => {\n            this.username = localIndexDb;\n        }), map((localIndexDb) => {\n            return localIndexDb ? true : false;\n        }));\n        this.turnOffAllLights$ = this.isAuthenticated$.pipe(filter((isAuthenticated) => isAuthenticated === true), switchMap((auth) => this.http.get(`${this.hueBridgeUrl}/${this.username}/lights`)), map((getResult) => {\n            const idList = [];\n            for (const prop in getResult) {\n                if (getResult.hasOwnProperty(prop)) {\n                    idList.push(prop);\n                }\n            }\n            return idList;\n        }), switchMap((lightIdList) => {\n            lightIdList.forEach((light) => this.http\n                .put(`${this.hueBridgeUrl}/${this.username}/lights/${light}/state`, {\n                on: false,\n            })\n                .pipe(take(1))\n                .subscribe());\n            return 'ok';\n        }));\n    }\n    registerAppToBridge() {\n        // TODO: incase of adding another screen, make this more dynamic\n        return this.http\n            .post(this.hueBridgeUrl, { devicetype: 'homescreen#homescreen_1' }, {})\n            .pipe(map((res) => res.pop()), switchMap((res) => {\n            var _a;\n            if ((_a = res.success) === null || _a === void 0 ? void 0 : _a.username) {\n                this.username = res.success.username;\n                this.localDb\n                    .set(this.HUE_USERNAME_KEY, res.success.username, {\n                    type: 'string',\n                })\n                    .pipe(take(1))\n                    .subscribe();\n                return of(true);\n            }\n            else {\n                return of(false);\n            }\n        }), timestamp(), switchMap(({ timestamp: ts, value: value }) => concat(of(value), EMPTY.pipe(delay(5000)))), repeat());\n    }\n    checkHueBridgeIp(ip) {\n        let formattedIp = ip.replace('http://', '');\n        formattedIp = formattedIp.replace('/api', '');\n        formattedIp = formattedIp.replace('/', '');\n        return this.isIp(formattedIp)\n            ? this.http\n                .get(`http://${formattedIp}/api/randomResource`, {\n                observe: 'response',\n            })\n                .pipe(timeout(3000))\n            : empty();\n    }\n    isIp(ipaddress) {\n        if (/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ipaddress)) {\n            return true;\n        }\n        return false;\n    }\n    saveHueBridgeIp(ip) {\n        let formattedIp = ip.replace('http://', '');\n        formattedIp = formattedIp.replace('/api', '');\n        formattedIp = formattedIp.replace('/', '');\n        return this.localDb.set(this.HUE_URL_KEY, `http://${formattedIp}/api`, {\n            type: 'string',\n        });\n    }\n    saveActivated(isActivated) {\n        return this.localDb.set(this.HUE_ISACTIVATED_KEY, isActivated, {\n            type: 'boolean',\n        });\n    }\n}\nLightService.ɵfac = function LightService_Factory(t) { return new (t || LightService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.StorageMap), i0.ɵɵinject(i3.Router), i0.ɵɵinject(i4.HotToastService)); };\nLightService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: LightService, factory: LightService.ɵfac, providedIn: 'root' });\n(function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightService, [{\n            type: Injectable,\n            args: [{\n                    providedIn: 'root',\n                }]\n        }], function () { return [{ type: i1.HttpClient }, { type: i2.StorageMap }, { type: i3.Router }, { type: i4.HotToastService }]; }, null);\n})();\n\nfunction LightButtonComponent_div_1_Template(rf, ctx) {\n    if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 4);\n        i0.ɵɵelement(1, \"img\", 5);\n        i0.ɵɵtext(2, \" Licht\");\n        i0.ɵɵelementEnd();\n    }\n}\nfunction LightButtonComponent_div_2_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r4 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"div\", 6);\n        i0.ɵɵelementStart(1, \"div\", 7);\n        i0.ɵɵlistener(\"click\", function LightButtonComponent_div_2_Template_div_click_1_listener() { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.turnOffAllLights(); });\n        i0.ɵɵtext(2, \" Licht ausmachen \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n    }\n}\nfunction LightButtonComponent_div_3_Template(rf, ctx) {\n    if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 8);\n        i0.ɵɵelementStart(1, \"ngx-spinner\", 9);\n        i0.ɵɵelementStart(2, \"p\", 10);\n        i0.ɵɵtext(3, \" Bitte die App an der Hue Bridge freigeben \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"fullScreen\", false);\n    }\n}\nclass LightButtonComponent {\n    constructor(lightsService, ngxSpinnerService, hotToast) {\n        this.lightsService = lightsService;\n        this.ngxSpinnerService = ngxSpinnerService;\n        this.hotToast = hotToast;\n        this.clickHueButton = false;\n        this.isAuthenticatedSub = this.lightsService.isAuthenticated$.subscribe((authenticated) => authenticated === false\n            ? this.tellUserToAuthenticate()\n            : this.setupLightConnection());\n    }\n    ngOnDestroy() {\n        if (!this.isAuthenticatedSub.closed) {\n            this.isAuthenticatedSub.unsubscribe();\n        }\n    }\n    ngOnInit() { }\n    tellUserToAuthenticate() {\n        this.registerAuthBridge = this.lightsService\n            .registerAppToBridge()\n            .subscribe((isAuthed) => {\n            if (!isAuthed) {\n                this.hotToast.show('Philips Hue Brauche Ihre Aufmerksamkeit!', {\n                    style: {\n                        background: 'rgba(255, 255, 255, 0.8)',\n                    },\n                    id: 'philips-hue',\n                    ariaLive: 'polite',\n                });\n                this.clickHueButton = true;\n                this.ngxSpinnerService.show('light-auth-spinner');\n            }\n            else {\n                this.setupLightConnection();\n                this.registerAuthBridge.unsubscribe();\n            }\n        });\n    }\n    setupLightConnection() {\n        this.clickHueButton = false;\n        if (this.isAuthenticatedSub && !this.isAuthenticatedSub.closed) {\n            this.isAuthenticatedSub.unsubscribe();\n        }\n    }\n    turnOffAllLights() {\n        this.lightsService.turnOffAllLights$\n            .pipe(take(1))\n            .subscribe((res) => console.log(res));\n    }\n}\nLightButtonComponent.ɵfac = function LightButtonComponent_Factory(t) { return new (t || LightButtonComponent)(i0.ɵɵdirectiveInject(LightService), i0.ɵɵdirectiveInject(i2$1.NgxSpinnerService), i0.ɵɵdirectiveInject(i4.HotToastService)); };\nLightButtonComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: LightButtonComponent, selectors: [[\"yah-light-button\"]], decls: 4, vars: 3, consts: [[1, \"box\"], [\"class\", \"header\", 4, \"ngIf\"], [\"class\", \"content\", 4, \"ngIf\"], [\"class\", \"authenticate-box\", 4, \"ngIf\"], [1, \"header\"], [\"src\", \"./assets/lamp.svg\"], [1, \"content\"], [1, \"glass-button\", 3, \"click\"], [1, \"authenticate-box\"], [\"name\", \"light-auth-spinner\", \"bdColor\", \"rgba(0,0,0,0)\", \"size\", \"medium\", \"color\", \"#fff\", \"type\", \"ball-scale\", 3, \"fullScreen\"], [2, \"color\", \"white\"]], template: function LightButtonComponent_Template(rf, ctx) {\n        if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0);\n            i0.ɵɵtemplate(1, LightButtonComponent_div_1_Template, 3, 0, \"div\", 1);\n            i0.ɵɵtemplate(2, LightButtonComponent_div_2_Template, 3, 0, \"div\", 2);\n            i0.ɵɵtemplate(3, LightButtonComponent_div_3_Template, 4, 1, \"div\", 3);\n            i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.clickHueButton);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.clickHueButton);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.clickHueButton);\n        }\n    }, directives: [i4$1.NgIf], styles: [\".box[_ngcontent-%COMP%]{background:rgba(255,255,255,.25);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;min-height:20rem;min-width:20rem;max-width:40rem;transition:all 50ms ease;position:relative}.box[_ngcontent-%COMP%]:active{box-shadow:0 .4rem 2rem #0000005e}.box[_ngcontent-%COMP%]   .authenticate-box[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:.7rem;min-height:inherit;max-width:inherit;background:rgba(255,255,255,.25);backdrop-filter:blur(.7rem);-webkit-backdrop-filter:blur(.7rem)}.box[_ngcontent-%COMP%]   .authenticate-box[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:6rem;height:6rem}.box[_ngcontent-%COMP%]   .authenticate-box[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{width:6rem;height:6rem;word-wrap:break-word;padding:1rem}.box[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-radius:.7rem .7rem 0 0;background:#fff;color:#000;font-size:2rem;display:grid;grid-template-columns:20fr 80fr;padding:.5rem 1rem}.box[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3rem;height:3rem}.content[_ngcontent-%COMP%]{display:flex;justify-content:center}.content[_ngcontent-%COMP%]   .glass-button[_ngcontent-%COMP%]{padding:1.5rem;margin-top:3rem;background:#d91313;border-radius:.7rem;box-shadow:0 .4rem 2rem #1f26875e;transition:all 50ms ease}.content[_ngcontent-%COMP%]   .glass-button[_ngcontent-%COMP%]:active{background:#ea1313}\"] });\n(function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightButtonComponent, [{\n            type: Component,\n            args: [{ selector: 'yah-light-button', template: \"<div class=\\\"box\\\">\\n  <div *ngIf=\\\"!clickHueButton\\\" class=\\\"header\\\"><img src=\\\"./assets/lamp.svg\\\" /> Licht</div>\\n\\n  <div *ngIf=\\\"!clickHueButton\\\" class=\\\"content\\\">\\n    <div class=\\\"glass-button\\\" (click)=\\\"turnOffAllLights()\\\"> Licht ausmachen </div>\\n  </div>\\n\\n  <div class=\\\"authenticate-box\\\" *ngIf=\\\"clickHueButton\\\">\\n    <ngx-spinner\\n      name=\\\"light-auth-spinner\\\"\\n      bdColor=\\\"rgba(0,0,0,0)\\\"\\n      size=\\\"medium\\\"\\n      color=\\\"#fff\\\"\\n      type=\\\"ball-scale\\\"\\n      [fullScreen]=\\\"false\\\"\\n      ><p style=\\\"color: white\\\">\\n        Bitte die App an der Hue Bridge freigeben\\n      </p></ngx-spinner\\n    >\\n  </div>\\n</div>\\n\\n<!-- <div>Icons made by <a href=\\\"https://www.flaticon.com/authors/pixel-perfect\\\" title=\\\"Pixel perfect\\\">Pixel perfect</a> from <a href=\\\"https://www.flaticon.com/\\\" title=\\\"Flaticon\\\">www.flaticon.com</a></div>\\n-->\\n\", styles: [\".box{background:rgba(255,255,255,.25);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;min-height:20rem;min-width:20rem;max-width:40rem;transition:all 50ms ease;position:relative}.box:active{box-shadow:0 .4rem 2rem #0000005e}.box .authenticate-box{display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:.7rem;min-height:inherit;max-width:inherit;background:rgba(255,255,255,.25);backdrop-filter:blur(.7rem);-webkit-backdrop-filter:blur(.7rem)}.box .authenticate-box>img{width:6rem;height:6rem}.box .authenticate-box .text{width:6rem;height:6rem;word-wrap:break-word;padding:1rem}.box .header{border-radius:.7rem .7rem 0 0;background:#fff;color:#000;font-size:2rem;display:grid;grid-template-columns:20fr 80fr;padding:.5rem 1rem}.box .header img{width:3rem;height:3rem}.content{display:flex;justify-content:center}.content .glass-button{padding:1.5rem;margin-top:3rem;background:#d91313;border-radius:.7rem;box-shadow:0 .4rem 2rem #1f26875e;transition:all 50ms ease}.content .glass-button:active{background:#ea1313}\\n\"] }]\n        }], function () { return [{ type: LightService }, { type: i2$1.NgxSpinnerService }, { type: i4.HotToastService }]; }, null);\n})();\n\nconst _c0 = [\"ipInput\"];\nclass LightSetupComponent {\n    constructor(lightService, toastMessage) {\n        this.lightService = lightService;\n        this.toastMessage = toastMessage;\n        this.validIp = 'disconnected';\n        this.isActivated = false;\n        this.lightService.hueBridgeIp$.subscribe((res) => {\n            if (res) {\n                this.ipInput.nativeElement.value = res;\n                this.validIp = 'connected';\n            }\n        });\n        this.lightService.isActivated$.subscribe((res) => {\n            this.isActivated = res;\n        });\n    }\n    ngOnInit() { }\n    checkIP() {\n        const input = this.ipInput.nativeElement.value;\n        if (input.length > 1) {\n            this.validIp = 'loading';\n            // Have we already fired it? Then let it run out..\n            if (this.checkingSubscription) {\n                this.checkingSubscription.unsubscribe();\n            }\n            this.checkingSubscription = this.lightService\n                .checkHueBridgeIp(input)\n                .pipe(debounceTime(750), distinctUntilChanged(), take(1))\n                .subscribe((res) => {\n                res.status === 200\n                    ? this.setNewHueValidIp(input)\n                    : this.showErrorMessage();\n            }, (err) => this.showErrorMessage());\n        }\n    }\n    showErrorMessage() {\n        this.validIp = 'disconnected';\n    }\n    setNewHueValidIp(input) {\n        this.checkingSubscription.unsubscribe();\n        this.validIp = 'connected';\n        this.lightService.saveHueBridgeIp(input).subscribe(() => {\n            this.toastMessage.success('Philips Hue server Einstellungen sind gespeichert', {\n                style: {\n                    background: 'rgba(255, 255, 255, 0.8)',\n                },\n                dismissible: true,\n                ariaLive: 'polite',\n                id: 'hue-saved',\n            });\n        });\n    }\n    setChecked($event) {\n        const input = $event.target;\n        this.lightService.saveActivated(input.checked).subscribe(() => {\n            this.toastMessage.success('Philips Hue server Einstellungen sind gespeichert', {\n                style: {\n                    background: 'rgba(255, 255, 255, 0.8)',\n                },\n                dismissible: true,\n                ariaLive: 'polite',\n                id: 'hue-saved',\n            });\n        });\n    }\n}\nLightSetupComponent.ɵfac = function LightSetupComponent_Factory(t) { return new (t || LightSetupComponent)(i0.ɵɵdirectiveInject(LightService), i0.ɵɵdirectiveInject(i4.HotToastService)); };\nLightSetupComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: LightSetupComponent, selectors: [[\"yah-light-setup\"]], viewQuery: function LightSetupComponent_Query(rf, ctx) {\n        if (rf & 1) {\n            i0.ɵɵviewQuery(_c0, 7);\n        }\n        if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.ipInput = _t.first);\n        }\n    }, decls: 16, vars: 4, consts: [[\"src\", \"assets/lamp.svg\", \"width\", \"32\"], [1, \"no-margin\"], [1, \"switch\"], [\"type\", \"checkbox\", 3, \"checked\", \"change\"], [1, \"slider\"], [1, \"input-row\"], [\"type\", \"text\", 1, \"input-frosted\", 3, \"input\"], [\"ipInput\", \"\"]], template: function LightSetupComponent_Template(rf, ctx) {\n        if (rf & 1) {\n            i0.ɵɵelementStart(0, \"form\");\n            i0.ɵɵelementStart(1, \"h2\");\n            i0.ɵɵelement(2, \"img\", 0);\n            i0.ɵɵtext(3, \" Philips Hue Server Einstellungen \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"p\", 1);\n            i0.ɵɵtext(5, \" Aktiviert \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"label\", 2);\n            i0.ɵɵelementStart(7, \"input\", 3);\n            i0.ɵɵlistener(\"change\", function LightSetupComponent_Template_input_change_7_listener($event) { return ctx.setChecked($event); });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(8, \"span\", 4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(9, \"p\");\n            i0.ɵɵelementStart(10, \"p\", 1);\n            i0.ɵɵtext(11, \" IP \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"div\", 5);\n            i0.ɵɵelementStart(13, \"input\", 6, 7);\n            i0.ɵɵlistener(\"input\", function LightSetupComponent_Template_input_input_13_listener() { return ctx.checkIP(); });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(15, \"i\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"checked\", ctx.isActivated);\n            i0.ɵɵadvance(8);\n            i0.ɵɵclassMapInterpolate1(\"symbol \", ctx.validIp, \"\");\n        }\n    }, styles: [\"form[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column}form[_ngcontent-%COMP%]   .no-margin[_ngcontent-%COMP%]{margin:0}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]{display:flex;align-items:center}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .input-frosted[_ngcontent-%COMP%]{color:#fff;font-size:1.4rem;font-weight:800;padding:1rem;border:none;background:rgba(255,255,255,.4);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;max-width:90%}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol[_ngcontent-%COMP%]{width:2rem;height:2rem;margin-left:.5rem}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol.connected[_ngcontent-%COMP%]{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22iso-8859-1%22%3F%3E%0D%3C!-- Generator%3A Adobe Illustrator 19.0.0%2C SVG Export Plug-In . SVG Version%3A 6.00 Build 0)  --%3E%0D%3Csvg version%3D%221.1%22 id%3D%22Layer_1%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 x%3D%220px%22 y%3D%220px%22%0D%09 viewBox%3D%220 0 511.999 511.999%22 style%3D%22enable-background%3Anew 0 0 511.999 511.999%3B%22 xml%3Aspace%3D%22preserve%22%3E%0D%3Cpath style%3D%22fill%3A%23B7E183%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L163.89%2C370.299L53.284%2C259.693%0D%09c-12.201-12.204-31.952-12.205-44.154-0.001c-12.173%2C12.174-12.173%2C31.981%2C0%2C44.153L141.814%2C436.53%0D%09c12.199%2C12.198%2C31.953%2C12.2%2C44.153%2C0L502.87%2C119.626C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cpath style%3D%22fill%3A%2371DE56%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L243.511%2C290.678v88.306L502.87%2C119.626%0D%09C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3C%2Fsvg%3E%0D\\\") no-repeat}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol.disconnected[_ngcontent-%COMP%]{background:url(\\\"data:image/svg+xml,%3Csvg height%3D%22100%25%22 viewBox%3D%220 0 329.26933 329%22 width%3D%2220%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg fill%3D%22%23f44336%22%3E%3Cpath d%3D%22m21.339844 329.398438c-5.460938 0-10.925782-2.089844-15.082032-6.25-8.34375-8.339844-8.34375-21.824219 0-30.164063l286.589844-286.59375c8.339844-8.339844 21.824219-8.339844 30.164063 0 8.34375 8.339844 8.34375 21.824219 0 30.164063l-286.589844 286.59375c-4.183594 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3Cpath d%3D%22m307.929688 329.398438c-5.460938 0-10.921876-2.089844-15.082032-6.25l-286.589844-286.59375c-8.34375-8.339844-8.34375-21.824219 0-30.164063 8.339844-8.339844 21.820313-8.339844 30.164063 0l286.589844 286.59375c8.34375 8.339844 8.34375 21.824219 0 30.164063-4.160157 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\") center no-repeat}form[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .symbol.loading[_ngcontent-%COMP%]{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22UTF-8%22 standalone%3D%22no%22%3F%3E%3Csvg xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 version%3D%221.0%22 width%3D%22100pt%22 height%3D%22100pt%22 viewBox%3D%220 0 128 128%22 xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23000%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23f8f8f8%22 transform%3D%22rotate(30 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23e8e8e8%22 transform%3D%22rotate(60 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23d4d4d4%22 transform%3D%22rotate(90 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23bebebe%22 transform%3D%22rotate(120 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23a6a6a6%22 transform%3D%22rotate(150 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%238e8e8e%22 transform%3D%22rotate(180 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23737373%22 transform%3D%22rotate(210 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%235a5a5a%22 transform%3D%22rotate(240 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23414141%22 transform%3D%22rotate(270 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%232a2a2a%22 transform%3D%22rotate(300 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23151515%22 transform%3D%22rotate(330 64 64)%22%2F%3E%3CanimateTransform attributeName%3D%22transform%22 type%3D%22rotate%22 values%3D%220 64 64%3B30 64 64%3B60 64 64%3B90 64 64%3B120 64 64%3B150 64 64%3B180 64 64%3B210 64 64%3B240 64 64%3B270 64 64%3B300 64 64%3B330 64 64%22 calcMode%3D%22discrete%22 dur%3D%22240ms%22 repeatCount%3D%22indefinite%22%3E%3C%2FanimateTransform%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\");background-size:contain}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:60px;height:34px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:\\\"\\\";height:26px;width:26px;left:4px;bottom:4px;background-color:#fff;transition:.4s}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2196f3}input[_ngcontent-%COMP%]:focus + .slider[_ngcontent-%COMP%]{box-shadow:0 0 1px #2196f3}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}\"] });\n(function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightSetupComponent, [{\n            type: Component,\n            args: [{ selector: 'yah-light-setup', template: \"<form>\\n\\n  <h2> <img src=\\\"assets/lamp.svg\\\" width=\\\"32\\\">  Philips Hue Server Einstellungen </h2>\\n  <p class=\\\"no-margin\\\"> Aktiviert </p>\\n  <label class=\\\"switch\\\">\\n    <input type=\\\"checkbox\\\" (change)=\\\"setChecked($event)\\\" [checked]=\\\"isActivated\\\">\\n    <span class=\\\"slider\\\"></span>\\n  </label>\\n\\n\\n  <p></p>\\n\\n  <p class=\\\"no-margin\\\"> IP </p>\\n  <div class=\\\"input-row\\\">\\n    <input #ipInput (input)='checkIP()' type=\\\"text\\\" class=\\\"input-frosted\\\">\\n    <i class=\\\"symbol {{validIp}}\\\" ></i>\\n  </div>\\n</form>\\n\\n\\n<!-- <div>Icons made by <a href=\\\"https://www.flaticon.com/authors/pixel-perfect\\\" title=\\\"Pixel perfect\\\">Pixel perfect</a> from <a href=\\\"https://www.flaticon.com/\\\" title=\\\"Flaticon\\\">www.flaticon.com</a></div> -->\\n\", styles: [\"form{display:flex;justify-content:center;flex-direction:column}form .no-margin{margin:0}form .input-row{display:flex;align-items:center}form .input-row .input-frosted{color:#fff;font-size:1.4rem;font-weight:800;padding:1rem;border:none;background:rgba(255,255,255,.4);backdrop-filter:blur(.2rem);-webkit-backdrop-filter:blur(.2rem);border-radius:.7rem;max-width:90%}form .input-row .symbol{width:2rem;height:2rem;margin-left:.5rem}form .input-row .symbol.connected{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22iso-8859-1%22%3F%3E%0D%3C!-- Generator%3A Adobe Illustrator 19.0.0%2C SVG Export Plug-In . SVG Version%3A 6.00 Build 0)  --%3E%0D%3Csvg version%3D%221.1%22 id%3D%22Layer_1%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 x%3D%220px%22 y%3D%220px%22%0D%09 viewBox%3D%220 0 511.999 511.999%22 style%3D%22enable-background%3Anew 0 0 511.999 511.999%3B%22 xml%3Aspace%3D%22preserve%22%3E%0D%3Cpath style%3D%22fill%3A%23B7E183%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L163.89%2C370.299L53.284%2C259.693%0D%09c-12.201-12.204-31.952-12.205-44.154-0.001c-12.173%2C12.174-12.173%2C31.981%2C0%2C44.153L141.814%2C436.53%0D%09c12.199%2C12.198%2C31.953%2C12.2%2C44.153%2C0L502.87%2C119.626C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cpath style%3D%22fill%3A%2371DE56%3B%22 d%3D%22M502.87%2C75.474c-12.201-12.204-31.952-12.205-44.154-0.001L243.511%2C290.678v88.306L502.87%2C119.626%0D%09C515.042%2C107.453%2C515.042%2C87.645%2C502.87%2C75.474z%22%2F%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3Cg%3E%0D%3C%2Fg%3E%0D%3C%2Fsvg%3E%0D\\\") no-repeat}form .input-row .symbol.disconnected{background:url(\\\"data:image/svg+xml,%3Csvg height%3D%22100%25%22 viewBox%3D%220 0 329.26933 329%22 width%3D%2220%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg fill%3D%22%23f44336%22%3E%3Cpath d%3D%22m21.339844 329.398438c-5.460938 0-10.925782-2.089844-15.082032-6.25-8.34375-8.339844-8.34375-21.824219 0-30.164063l286.589844-286.59375c8.339844-8.339844 21.824219-8.339844 30.164063 0 8.34375 8.339844 8.34375 21.824219 0 30.164063l-286.589844 286.59375c-4.183594 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3Cpath d%3D%22m307.929688 329.398438c-5.460938 0-10.921876-2.089844-15.082032-6.25l-286.589844-286.59375c-8.34375-8.339844-8.34375-21.824219 0-30.164063 8.339844-8.339844 21.820313-8.339844 30.164063 0l286.589844 286.59375c8.34375 8.339844 8.34375 21.824219 0 30.164063-4.160157 4.179687-9.621094 6.25-15.082031 6.25zm0 0%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\") center no-repeat}form .input-row .symbol.loading{background:url(\\\"data:image/svg+xml,%3C%3Fxml version%3D%221.0%22 encoding%3D%22UTF-8%22 standalone%3D%22no%22%3F%3E%3Csvg xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22 version%3D%221.0%22 width%3D%22100pt%22 height%3D%22100pt%22 viewBox%3D%220 0 128 128%22 xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23000%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23f8f8f8%22 transform%3D%22rotate(30 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23e8e8e8%22 transform%3D%22rotate(60 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23d4d4d4%22 transform%3D%22rotate(90 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23bebebe%22 transform%3D%22rotate(120 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23a6a6a6%22 transform%3D%22rotate(150 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%238e8e8e%22 transform%3D%22rotate(180 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23737373%22 transform%3D%22rotate(210 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%235a5a5a%22 transform%3D%22rotate(240 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23414141%22 transform%3D%22rotate(270 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%232a2a2a%22 transform%3D%22rotate(300 64 64)%22%2F%3E%3Cpath d%3D%22M64 1.5a62.8 62.8 0 0 0-12.4 1.23l-.38-1.45a64.56 64.56 0 0 1 25.57 0l-.4 1.45A62.78 62.78 0 0 0 64 1.5zm0 3a59.78 59.78 0 0 1 11.62 1.14L71.34 21.6a43.43 43.43 0 0 0-14.67.04l-4.3-16A59.78 59.78 0 0 1 64.02 4.5z%22 fill%3D%22%23151515%22 transform%3D%22rotate(330 64 64)%22%2F%3E%3CanimateTransform attributeName%3D%22transform%22 type%3D%22rotate%22 values%3D%220 64 64%3B30 64 64%3B60 64 64%3B90 64 64%3B120 64 64%3B150 64 64%3B180 64 64%3B210 64 64%3B240 64 64%3B270 64 64%3B300 64 64%3B330 64 64%22 calcMode%3D%22discrete%22 dur%3D%22240ms%22 repeatCount%3D%22indefinite%22%3E%3C%2FanimateTransform%3E%3C%2Fg%3E%3C%2Fsvg%3E\\\");background-size:contain}.switch{position:relative;display:inline-block;width:60px;height:34px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider:before{position:absolute;content:\\\"\\\";height:26px;width:26px;left:4px;bottom:4px;background-color:#fff;transition:.4s}input:checked+.slider{background-color:#2196f3}input:focus+.slider{box-shadow:0 0 1px #2196f3}input:checked+.slider:before{transform:translate(26px)}\\n\"] }]\n        }], function () { return [{ type: LightService }, { type: i4.HotToastService }]; }, { ipInput: [{\n                type: ViewChild,\n                args: ['ipInput', { static: true }]\n            }] });\n})();\n\nclass LightModule {\n}\nLightModule.ɵfac = function LightModule_Factory(t) { return new (t || LightModule)(); };\nLightModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: LightModule });\nLightModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[CommonModule, HotToastModule]] });\n(function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LightModule, [{\n            type: NgModule,\n            args: [{\n                    declarations: [LightButtonComponent, LightSetupComponent],\n                    imports: [CommonModule, HotToastModule],\n                    exports: [LightButtonComponent, LightSetupComponent],\n                }]\n        }], null, null);\n})();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(LightModule, { declarations: [LightButtonComponent, LightSetupComponent], imports: [CommonModule, HotToastModule], exports: [LightButtonComponent, LightSetupComponent] }); })();\n\n/*\n * Public API Surface of yah-light\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { LightButtonComponent, LightModule, LightService, LightSetupComponent };\n","map":{"version":3,"file":"yah-light.mjs","sources":["../../../projects/yah-light/src/lib/services/light.service.ts","../../../projects/yah-light/src/lib/components/light-button/light-button.component.html","../../../projects/yah-light/src/lib/components/light-button/light-button.component.ts","../../../projects/yah-light/src/lib/components/light-setup/light-setup.component.ts","../../../projects/yah-light/src/lib/components/light-setup/light-setup.component.html","../../../projects/yah-light/src/lib/light.module.ts","../../../projects/yah-light/src/public-api.ts","../../../projects/yah-light/src/yah-light.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\nimport {combineLatest, concat, empty, EMPTY, Observable, of,} from 'rxjs';\nimport {HttpClient, HttpResponse,} from '@angular/common/http';\nimport {delay, filter, map, repeat, switchMap, take, tap, timeout, timestamp,} from 'rxjs/operators';\nimport {StorageMap} from '@ngx-pwa/local-storage';\nimport {Router} from '@angular/router';\nimport {HotToastService} from '@ngneat/hot-toast';\n\nexport interface HueInternalModel {\n  error?: {\n    type: number;\n    address: string;\n    description: string;\n  };\n  success?: {\n    username: string;\n  };\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LightService {\n  public isActivated$: Observable<boolean>;\n\n  public hueBridgeIp$: Observable<string>;\n  public validHueBridgeIp$: Observable<boolean>;\n\n  public isAuthenticated$: Observable<boolean>;\n\n  public turnOffAllLights$: Observable<string>;\n\n  private isActivated: boolean | undefined;\n  private username: string;\n  private hueBridgeUrl: string;\n\n  private readonly HUE_ISACTIVATED_KEY = 'HUE_ACTIVATED';\n  private readonly HUE_USERNAME_KEY = 'HUE_USERNAME';\n  private readonly HUE_URL_KEY = 'HUE_URL';\n\n  constructor(\n    private http: HttpClient,\n    private localDb: StorageMap,\n    private router: Router,\n    private toastMessage: HotToastService\n  ) {\n    this.isActivated$ = localDb\n      .get(this.HUE_ISACTIVATED_KEY, { type: 'boolean' })\n      .pipe(tap((res) => (this.isActivated = res)));\n\n    this.hueBridgeIp$ = combineLatest([\n      localDb.watch(this.HUE_URL_KEY, { type: 'string' }),\n      this.isActivated$,\n    ]).pipe(\n      map(([res, isActivated]) => {\n        if (isActivated === undefined) {\n          this.toastMessage.warning('Lass uns uns sachen erstmal einstellen ', {\n            style: {\n              background: 'rgba(255, 255, 255, 0.8)',\n            },\n            dismissible: true,\n            ariaLive: 'polite',\n          });\n          this.router.navigate(['setup', { outlets: { options: 'light' } }], ).then();\n          return;\n        }\n        return res;\n      }),\n      tap((res) => (this.hueBridgeUrl = res))\n    );\n\n    this.validHueBridgeIp$ = this.hueBridgeIp$.pipe(\n      map((res) => (res ? true : false))\n    );\n\n    this.isAuthenticated$ = combineLatest([\n      localDb.get<boolean>(this.HUE_USERNAME_KEY, { type: 'string' }),\n      this.validHueBridgeIp$,\n      this.isActivated$,\n    ]).pipe(\n      map(([username, validIP, isActivated]) => {\n        if (!isActivated) {\n          return;\n        }\n\n        if (!validIP) {\n          this.toastMessage.error(\n            'Leider fehlt informationen von die Philips Hue.',\n            {\n              style: {\n                background: 'rgba(255, 255, 255, 0.8)',\n              },\n              dismissible: true,\n              ariaLive: 'polite',\n            }\n          );\n          return;\n        }\n        return username;\n      }),\n      tap((localIndexDb) => {\n        this.username = localIndexDb;\n      }),\n      map((localIndexDb) => {\n        return localIndexDb ? true : false;\n      })\n    );\n\n    this.turnOffAllLights$ = this.isAuthenticated$.pipe(\n      filter((isAuthenticated) => isAuthenticated === true),\n      switchMap((auth) =>\n        this.http.get<JSON>(`${this.hueBridgeUrl}/${this.username}/lights`)\n      ),\n      map((getResult) => {\n        const idList: string[] = [];\n        for (const prop in getResult) {\n          if (getResult.hasOwnProperty(prop)) {\n            idList.push(prop);\n          }\n        }\n        return idList;\n      }),\n      switchMap((lightIdList) => {\n        lightIdList.forEach((light) =>\n          this.http\n            .put(\n              `${this.hueBridgeUrl}/${this.username}/lights/${light}/state`,\n              {\n                on: false,\n              }\n            )\n            .pipe(take(1))\n            .subscribe()\n        );\n\n        return 'ok';\n      })\n    );\n  }\n\n  public registerAppToBridge(): Observable<boolean> {\n    // TODO: incase of adding another screen, make this more dynamic\n    return this.http\n      .post<HueInternalModel[]>(\n        this.hueBridgeUrl,\n        { devicetype: 'homescreen#homescreen_1' },\n        {}\n      )\n      .pipe(\n        map((res) => res.pop()),\n        switchMap((res) => {\n          if (res.success?.username) {\n            this.username = res.success.username;\n            this.localDb\n              .set(this.HUE_USERNAME_KEY, res.success.username, {\n                type: 'string',\n              })\n              .pipe(take(1))\n              .subscribe();\n            return of(true);\n          } else {\n            return of(false);\n          }\n        }),\n        timestamp(),\n        switchMap(({ timestamp: ts, value: value }) =>\n          concat(of(value), EMPTY.pipe(delay(5000)))\n        ),\n        repeat()\n      );\n  }\n\n  public checkHueBridgeIp(ip: string): Observable<HttpResponse<any>> {\n    let formattedIp = ip.replace('http://', '');\n    formattedIp = formattedIp.replace('/api', '');\n    formattedIp = formattedIp.replace('/', '');\n    return this.isIp(formattedIp)\n      ? this.http\n          .get<HttpResponse<any>>(`http://${formattedIp}/api/randomResource`, {\n            observe: 'response',\n          })\n          .pipe(timeout(3000))\n      : empty();\n  }\n\n  private isIp(ipaddress: string): boolean {\n    if (\n      /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(\n        ipaddress\n      )\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  public saveHueBridgeIp(ip: string): Observable<null> {\n    let formattedIp = ip.replace('http://', '');\n    formattedIp = formattedIp.replace('/api', '');\n    formattedIp = formattedIp.replace('/', '');\n\n    return this.localDb.set(this.HUE_URL_KEY, `http://${formattedIp}/api`, {\n      type: 'string',\n    });\n  }\n\n  saveActivated(isActivated: boolean): Observable<null> {\n    return this.localDb.set(this.HUE_ISACTIVATED_KEY, isActivated, {\n      type: 'boolean',\n    });\n  }\n}\n","<div class=\"box\">\n  <div *ngIf=\"!clickHueButton\" class=\"header\"><img src=\"./assets/lamp.svg\" /> Licht</div>\n\n  <div *ngIf=\"!clickHueButton\" class=\"content\">\n    <div class=\"glass-button\" (click)=\"turnOffAllLights()\"> Licht ausmachen </div>\n  </div>\n\n  <div class=\"authenticate-box\" *ngIf=\"clickHueButton\">\n    <ngx-spinner\n      name=\"light-auth-spinner\"\n      bdColor=\"rgba(0,0,0,0)\"\n      size=\"medium\"\n      color=\"#fff\"\n      type=\"ball-scale\"\n      [fullScreen]=\"false\"\n      ><p style=\"color: white\">\n        Bitte die App an der Hue Bridge freigeben\n      </p></ngx-spinner\n    >\n  </div>\n</div>\n\n<!-- <div>Icons made by <a href=\"https://www.flaticon.com/authors/pixel-perfect\" title=\"Pixel perfect\">Pixel perfect</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div>\n-->\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { LightService } from '../../services/light.service';\nimport { NgxSpinnerService } from 'ngx-spinner';\nimport { Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { HotToastService } from '@ngneat/hot-toast';\n\n@Component({\n  selector: 'yah-light-button',\n  templateUrl: './light-button.component.html',\n  styleUrls: ['./light-button.component.scss'],\n})\nexport class LightButtonComponent implements OnInit, OnDestroy {\n  clickHueButton = false;\n\n  isAuthenticatedSub: Subscription;\n  registerAuthBridge: Subscription;\n\n  constructor(\n    private lightsService: LightService,\n    private ngxSpinnerService: NgxSpinnerService,\n    private hotToast: HotToastService\n  ) {\n    this.isAuthenticatedSub = this.lightsService.isAuthenticated$.subscribe(\n      (authenticated) =>\n        authenticated === false\n          ? this.tellUserToAuthenticate()\n          : this.setupLightConnection()\n    );\n  }\n\n  ngOnDestroy(): void {\n    if (!this.isAuthenticatedSub.closed){\n      this.isAuthenticatedSub.unsubscribe();\n    }\n  }\n\n  ngOnInit(): void {}\n\n  private tellUserToAuthenticate(): void {\n    this.registerAuthBridge = this.lightsService\n      .registerAppToBridge()\n      .subscribe((isAuthed) => {\n        if (!isAuthed) {\n          this.hotToast.show('Philips Hue Brauche Ihre Aufmerksamkeit!', {\n            style: {\n              background: 'rgba(255, 255, 255, 0.8)',\n            },\n            id: 'philips-hue',\n            ariaLive: 'polite',\n          });\n          this.clickHueButton = true;\n          this.ngxSpinnerService.show('light-auth-spinner');\n        } else {\n          this.setupLightConnection();\n          this.registerAuthBridge.unsubscribe();\n        }\n      });\n  }\n\n  private setupLightConnection(): void {\n    this.clickHueButton = false;\n\n    if (this.isAuthenticatedSub && !this.isAuthenticatedSub.closed) {\n      this.isAuthenticatedSub.unsubscribe();\n    }\n  }\n\n  public turnOffAllLights(): void {\n    this.lightsService.turnOffAllLights$\n      .pipe(take(1))\n      .subscribe((res) => console.log(res));\n  }\n}\n","import { debounceTime, distinctUntilChanged, take } from 'rxjs/operators';\nimport { LightService } from './../../services/light.service';\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { HotToastService } from '@ngneat/hot-toast';\n\n@Component({\n  selector: 'yah-light-setup',\n  templateUrl: './light-setup.component.html',\n  styleUrls: ['./light-setup.component.scss'],\n})\nexport class LightSetupComponent implements OnInit {\n  @ViewChild('ipInput', { static: true }) ipInput: ElementRef<HTMLInputElement>;\n\n  checkingSubscription: Subscription;\n\n  validIp = 'disconnected';\n  isActivated = false;\n\n  constructor(\n    private lightService: LightService,\n    private toastMessage: HotToastService\n  ) {\n    this.lightService.hueBridgeIp$.subscribe((res) => {\n      if (res) {\n        this.ipInput.nativeElement.value = res;\n        this.validIp = 'connected';\n      }\n    });\n\n    this.lightService.isActivated$.subscribe((res) => {\n      this.isActivated = res;\n    });\n  }\n\n  ngOnInit(): void {}\n\n  public checkIP(): void {\n    const input = this.ipInput.nativeElement.value;\n\n    if (input.length > 1) {\n      this.validIp = 'loading';\n\n      // Have we already fired it? Then let it run out..\n      if (this.checkingSubscription) {\n        this.checkingSubscription.unsubscribe();\n      }\n\n      this.checkingSubscription = this.lightService\n        .checkHueBridgeIp(input)\n        .pipe(debounceTime(750), distinctUntilChanged(), take(1))\n        .subscribe(\n          (res) => {\n            res.status === 200\n              ? this.setNewHueValidIp(input)\n              : this.showErrorMessage();\n          },\n          (err) => this.showErrorMessage()\n        );\n    }\n  }\n  public showErrorMessage(): void {\n    this.validIp = 'disconnected';\n  }\n  public setNewHueValidIp(input: string): void {\n    this.checkingSubscription.unsubscribe();\n    this.validIp = 'connected';\n    this.lightService.saveHueBridgeIp(input).subscribe(() => {\n      this.toastMessage.success(\n        'Philips Hue server Einstellungen sind gespeichert',\n        {\n          style: {\n            background: 'rgba(255, 255, 255, 0.8)',\n          },\n          dismissible: true,\n          ariaLive: 'polite',\n          id: 'hue-saved',\n        }\n      );\n    });\n  }\n\n  public setChecked($event: Event): void {\n    const input = $event.target as HTMLInputElement;\n    this.lightService.saveActivated(input.checked).subscribe(() => {\n      this.toastMessage.success(\n        'Philips Hue server Einstellungen sind gespeichert',\n        {\n          style: {\n            background: 'rgba(255, 255, 255, 0.8)',\n          },\n          dismissible: true,\n          ariaLive: 'polite',\n          id: 'hue-saved',\n        }\n      );\n    });\n  }\n}\n","<form>\n\n  <h2> <img src=\"assets/lamp.svg\" width=\"32\">  Philips Hue Server Einstellungen </h2>\n  <p class=\"no-margin\"> Aktiviert </p>\n  <label class=\"switch\">\n    <input type=\"checkbox\" (change)=\"setChecked($event)\" [checked]=\"isActivated\">\n    <span class=\"slider\"></span>\n  </label>\n\n\n  <p></p>\n\n  <p class=\"no-margin\"> IP </p>\n  <div class=\"input-row\">\n    <input #ipInput (input)='checkIP()' type=\"text\" class=\"input-frosted\">\n    <i class=\"symbol {{validIp}}\" ></i>\n  </div>\n</form>\n\n\n<!-- <div>Icons made by <a href=\"https://www.flaticon.com/authors/pixel-perfect\" title=\"Pixel perfect\">Pixel perfect</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div> -->\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {LightButtonComponent} from './components/light-button/light-button.component';\nimport {LightSetupComponent} from './components/light-setup/light-setup.component';\nimport {HotToastModule} from '@ngneat/hot-toast';\n\n@NgModule({\n  declarations: [LightButtonComponent, LightSetupComponent],\n  imports: [CommonModule, HotToastModule],\n  exports: [LightButtonComponent, LightSetupComponent],\n})\nexport class LightModule {}\n","/*\n * Public API Surface of yah-light\n */\n\nexport * from './lib/light.module';\nexport * from './lib/components/light-button/light-button.component';\nexport * from './lib/components/light-setup/light-setup.component';\n\nexport * from './lib/services/light.service';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}}}